package main

import (
	"bufio"
	"fmt"
	"net"
	"os"
	"strings"
)

var (
	host = "0.0.0.0"
	port = 6969
)

// var text = `Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.Vestibulum gravida convallis porta. Vivamus pharetra tristique mauris, et luctus lacus condimentum vel. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed finibus metus a erat commodo, id gravida sem rutrum. Fusce efficitur erat ut ante egestas, eu vestibulum erat porttitor. Nam lacinia nulla sit amet interdum semper. Sed pulvinar luctus ligula eu laoreet. Ut in diam interdum dolor convallis condimentum eu ut ligula. Cras nec laoreet mi, et ultricies felis. Nulla id sem pulvinar, dapibus elit quis, suscipit sapien. Sed euismod tortor sed ipsum semper, aliquam pulvinar dui sagittis. Phasellus eu sollicitudin sem. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos.}`

func main() {
	addr := net.UDPAddr{IP: net.ParseIP(host), Port: port}
	handleClient(addr)
}

func handleClient(addr net.UDPAddr) {
	c, err := net.DialUDP("udp", nil, &addr)
	if err != nil {
		fmt.Println(err)
		return
	}

	fmt.Printf("The UDP server is %s\n", c.RemoteAddr().String())
	defer c.Close()

	for {
		reader := bufio.NewReader(os.Stdin)
		fmt.Print(">> ")
		text, _ := reader.ReadString('\n')
		data := []byte(text)
		_, err = c.Write(data)
		if strings.TrimSpace(string(data)) == "STOP" {
			fmt.Println("Exiting UDP client!")
			return
		}

		if err != nil {
			fmt.Println(err)
			return
		}
	}
}
